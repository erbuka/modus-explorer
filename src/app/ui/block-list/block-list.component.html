<ng-container *ngIf="item">
    <div class="d-flex h-100 p-4" *ngIf="!context.editorMode.value">
        <div class="d-flex flex-wrap justify-content-center cn-block-list m-auto">
            <div *ngFor="let l of item.links;index as i" class="cn-block-list-item p-1 animated fadeInRight"
                [style.animation-delay]="0.1 * i + 's'" [style.width]="item.options.itemWidth">
                <div class="cn-relative mat-elevation-z4 w-100" [routerLink]="['/', l.itemId]">
                    <img class="d-block cn-object-cover w-100" [style.aspect-ratio]="item.options.itemAspectRatio"
                        [src]="l.image">
                    <div class="cn-overlay cn-bg-cover" [appBgImage]="l.image | cnUrl : item"></div>
                    <div class="cn-overlay cn-block-list-hover" style="background-color: rgba(0,0,0,.5);"></div>
                    <div class="cn-overlay d-flex align-items-end w-100">
                        <div class="cn-block-list-label m-0 flex-grow-1" [innerHTML]="l.title | cnLocalizedText"></div>
                    </div>
                </div>
            </div>

            <div *ngIf="context.editorMode.value" class="cn-block-list-item p-1 animated fadeInRight"
                [style.width]="item.options.itemWidth">
                <div class="cn-relative mat-elevation-z4" (click)="addLink()"
                    [style.padding-bottom]="(1 / item.options.itemAspectRatio * 100) + '%'">
                    <div class="cn-overlay d-flex align-items-center justify-content-center">
                        <mat-icon>add</mat-icon>
                    </div>
                    <div class="cn-overlay cn-block-list-hover" style="background-color: rgba(0,0,0,.5);"></div>
                </div>
            </div>

        </div>
    </div>

    <ng-container *ngIf="context.editorMode.value">
        <div class="cn-editor-mode-context">
            <div class="cn-block-list-editor cn-editor">
                <div class="cn-sidebar">

                    <div class="p-3">
                        <mat-form-field class="d-block">
                            <mat-label>Title</mat-label>
                            <app-editable-localized-text [(data)]="item.title"></app-editable-localized-text>
                        </mat-form-field>

                        <mat-form-field class="d-block">
                            <mat-label>Item Width</mat-label>
                            <input type="text" matInput [(ngModel)]="item.options.itemWidth">
                        </mat-form-field>
                        <mat-form-field class="d-block">
                            <mat-label>Item Aspect Ratio</mat-label>
                            <input type="text" matInput [(ngModel)]="item.options.itemAspectRatio">
                        </mat-form-field>
                        <div class="text-center">
                            <button mat-raised-button color="accent" (click)="addLink()">
                                <mat-icon>add</mat-icon> New Link
                            </button>
                        </div>
                    </div>

                    <div class="cn-list" cdkDropList (cdkDropListDropped)="onLinkDropped($event)">
                        <div *ngFor="let l of item.links;index as i" cdkDrag
                            [class.cn-selected]="editorMode.selectedLink === l">
                            <button mat-icon-button (click)="deleteLink(i)">
                                <mat-icon>delete</mat-icon>
                            </button>
                            <button mat-icon-button (click)="editorMode.selectedLink = l">
                                <mat-icon>edit</mat-icon>
                            </button>
                            <button cdkDragHandle mat-icon-button>
                                <mat-icon>drag_handle</mat-icon>
                            </button>

                            <div class="cn-label" [innerHTML]="l.title | cnLocalizedText"></div>
                            <div *cdkDragPreview class="p-3 mat-elevation-z4">{{ l.title | cnLocalizedText }}</div>

                        </div>



                    </div>
                </div>

                <div class="cn-content">
                    <ng-container *ngIf="editorMode.selectedLink">
                        <div class="row">
                            <mat-form-field class="col-12">
                                <mat-label>Image</mat-label>
                                <app-file-input [item]="this.item"
                                    [(url)]="editorMode.selectedLink.image"></app-file-input>
                            </mat-form-field>

                            <mat-form-field class="col-12">
                                <mat-label>Title</mat-label>
                                <app-editable-localized-text
                                    [(data)]="editorMode.selectedLink.title"></app-editable-localized-text>
                            </mat-form-field>

                            <mat-form-field class="col-12">
                                <mat-label>Destination Item</mat-label>
                                <app-item-input [(value)]="editorMode.selectedLink.itemId"></app-item-input>
                            </mat-form-field>

                        </div>

                    </ng-container>
                    <ng-container *ngIf="!editorMode.selectedLink">
                        <div class="w-100 h-100 d-flex align-items-center justify-content-center">Please select a link
                        </div>
                    </ng-container>
                </div>
            </div>
        </div>


    </ng-container>

</ng-container>